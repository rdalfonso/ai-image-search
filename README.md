# llm_studio_server.py

This script automates the renaming of image files using metadata generated by a Large Language Model (LLM) API. It parses the LLM's JSON response, extracts descriptive information, and renames/moves image files accordingly.

## Requirements
- LLM Studio
- Download the google/gemma-3n-e4b model

## Features
- Calls an LLM API to generate metadata for images
- Parses JSON responses (removes Markdown formatting if present)
- Renames images based on LLM-generated names
- Moves renamed images to a target directory
- Logs operations and errors

## Dependencies
- Python 3.7+
- Standard library: `os`, `json`
- Likely required: `openai` (or similar LLM API client)
- LLM Studio

## Usage
1. **Install dependencies**
   ```bash
   pip install openai
   ```
2. **Configure your LLM API key**
 - LLM Studio server http://localhost:1234/v1 running with google/gemma-3n-e4b loaded.
3. **Prepare your images**
   - Place images in the source directory (e.g., `images/`)
4. **Run the script**
   ```bash
   python lm_studio_server.py
   ```
5. **Result**
   - Images will be renamed and moved to the target directory (e.g., `images_renamed/`)
   - Console output will show the new names and descriptions
   - The new names and descriptions will be stored in a local chromadb vector database.
   - A gradio chat will be created to "chat with your content".

## Error Handling
- The script will print warnings if JSON parsing fails or if file operations encounter errors.
- It sanitizes filenames to avoid invalid characters.

## Example Output
```
Renamed cat.jpg to cat_looking_up.jpg
Description: A cat looking up at the sky.
```

## Notes
- The script assumes the LLM returns a JSON object with `description` and `name` fields.
- If the LLM response is wrapped in Markdown (e.g., ```json ... ```), the script strips it before parsing.
- You may need to adjust the model name or API endpoint for your environment.

---

For more details, see the source code in `llm_studio_server.py`.
